# DynamoDB 概要

## DynamoDB とは

AWS が提供する**フルマネージド NoSQL データベースサービス**。Key-Value 型およびドキュメント型のデータモデルをサポートする。

## 主な特徴

| 特徴 | 説明 |
|---|---|
| **フルマネージド** | サーバーのプロビジョニング、パッチ適用、スケーリングなどを AWS が自動管理。運用負荷が極めて低い |
| **スケーラビリティ** | テーブルサイズに上限がなく、自動的に水平スケーリング。毎秒数百万リクエストを処理可能 |
| **低レイテンシ** | 1桁ミリ秒台の一貫したレスポンスタイム。DAX（インメモリキャッシュ）を使えばマイクロ秒台も可能 |
| **スキーマレス** | テーブル作成時にキー属性のみ定義すれば、各アイテムは自由な属性を持てる |
| **料金モデル** | オンデマンド（使った分だけ）とプロビジョンド（事前にキャパシティ予約）の2種類 |

## データモデルの基本概念

- **テーブル**: RDB のテーブルに相当。データの格納先
- **アイテム**: RDB の行（レコード）に相当。1件のデータ
- **属性**: RDB の列（カラム）に相当。各アイテムが持つデータフィールド
- **パーティションキー (PK)**: 必須。アイテムを一意に（または分散して）格納するためのキー。ハッシュ関数で物理パーティションが決まる
- **ソートキー (SK)**: 任意。PK と組み合わせて複合主キーを構成する。同一 PK 内でのソートや範囲クエリが可能になる

## RDB との違い

| 観点 | RDB | DynamoDB |
|---|---|---|
| スキーマ | 厳密に定義 | キーのみ定義、他は自由 |
| スケーリング | 垂直スケール中心 | 水平スケール（自動） |
| クエリ | SQL で柔軟に | キー設計に基づく制約あり |
| JOIN | 可能 | 不可（非正規化で対応） |
| トランザクション | 標準サポート | 制限付きサポート（TransactWriteItems/TransactGetItems） |
| 設計アプローチ | データモデルから設計 | **アクセスパターンから設計** |

## 最も重要な設計原則

DynamoDB は**アクセスパターン駆動設計**。RDB のように「まずデータを正規化して、あとからクエリを考える」のではなく、**「どんなクエリが必要か」を先に洗い出してからテーブル設計する**。これが RDB 経験者にとって最大のパラダイムシフト。

## IoT でのユースケース

センサーデータの蓄積は DynamoDB の代表的なユースケース。

- **PK**: センサーID（`sensor#001` など）
- **SK**: タイムスタンプ（`2026-02-22T10:00:00Z` など）

この設計により「特定のセンサーの直近1時間のデータ」のようなクエリが効率的に実行できる。
